<!doctype html>
<html>

<head>

	<meta charset="UTF-8">
	<title>Examination Session IB Diploma Programme - GCLC</title>
	<link href="diseno.css" rel="stylesheet" type="text/css">
	<script src="FileSaver.js"></script>

</head>

<body onload="startTime()">
	<div id="contenido">
		<div style="text-align: center; padding-top: 10px"><a href="index-2.html"><img src="img/Logo.png" width="412"
					height="200" alt=""></a></div>

		<div id="titulo">
			<h1>IB Examination Timers</h1>
		</div>

		<div class="container" style="margin: 0px; border: 0.0em solid white;">
			<div class="left" style="float: left; border: 0.5em solid white; padding: 20px;">
				<div>Current Time Exam 1</div>
				<div style="margin-top: -10px;" id="hora">00:00</div>
				<div class="panel">
					<div id="formulario">
						<p style="margin: 10px;">
							<label>Subject: </label><input type="text" name="asignatura" id="asignatura"
								style="width: 220px;">
							<label style="padding-left: 15px">Level: </label><select name="nivel" id="nivel">
								<option value="ML">ML</option>
								<option value="SL">SL</option>
							</select>
							<label style="padding-left: 15px">Test: </label><select id="prueba">
								<option value="T1">T1</option>
								<option value="T2">T2</option>
								<option value="T3">T3</option>
							</select>
						</p>
						<p style="margin-top: 10px; margin-bottom: 10px;">
							<label>Duration in Hours: </label><input type="number" name="horasex" id="horasex"
								style="width: 60px;"><label style="padding-left: 15px; width: 20px;"> Min:
							</label><input type="number" name="minex" id="minex" style="width: 60px;"><label
								style="padding-left: 35px; width: 20px;">
						</p>
						<p style="margin-top: 10px;">Invigilator: </label><input type="text" name="iniciales"
								id="iniciales" style="width: 60px; text-transform: uppercase;">
						</p>
					</div>
					<div id="activada" style="display: none">
						<p style="margin: 10px;">Subject: <span style="padding-right: 10px"
								id="asignaturaactivada"></span>
							Level: <span id="nivelactivada" style="padding-right: 10px"></span> Test: <span
								id="pruebaactivada"></span> </p>
						<p style="margin-top: 10px; margin-bottom: 10px;">Examination Time: <span
								style="padding-right: 30px" id="tiempoactivada"></span></p>
						<p style="margin-top: 10px;">Invigilator: <span id="inicialesactivada"
								style="text-transform: uppercase;"></span></p>
					</div>
					<div id="iniciada" style="display: none">
						<p style="margin: 10px;">Subject: <span style="padding-right: 7px"
								id="asignaturainiciada"></span>
							Level: <span id="niveliniciada" style="padding-right: 7px"></span> Test: <span
								id="pruebainiciada"></span> </p>
						<p style="margin-top: 10px;">Examination Time: <span id="tiempoiniciada"></span></p>
						<span style="font-size: 170%">
							<p style="margin: 20px;">Start Time: <span id="inicio"></span> <br />End Time: <span
									id="fin" style="color: red"></span></p>
							<p style="font-size: x-large; font-weight: bold;">Remaining 30' at <span id="30"
									style="padding-right: 40px"></span>Remaining 5' at <span id="5"></span><br /></p>
						</span>
					</div>
				</div>
			</div>

			<div class="right" style="float: right; border: 0.5em solid white; padding: 20px;">
				<div>Current Time Exam 2</div>
				<div style="margin-top: -10px;" id="hora2">00:00</div>
				<div class="panel">
					<div id="formulario2">
						<p style="margin: 10px;">
							<label>Subject: </label><input type="text" name="asignatura" id="asignatura2"
								style="width: 220px;">
							<label style="padding-left: 15px">Level: </label><select name="nivel" id="nivel2">
								<option value="ML">ML</option>
								<option value="SL">SL</option>
							</select>
							<label style="padding-left: 15px">Test: </label><select id="prueba2">
								<option value="T1">T1</option>
								<option value="T2">T2</option>
								<option value="T3">T3</option>
							</select>
						</p>
						<p style="margin-top: 10px; margin-bottom: 10px;">
							<label>Duration in Hours: </label><input type="number" name="horasex" id="horasex2"
								style="width: 60px;"><label style="padding-left: 15px; width: 20px;"> Min:
							</label><input type="number" name="minex" id="minex2" style="width: 60px;"><label
								style="padding-left: 35px; width: 20px;">
						</p>
						<p style="margin-top: 10px;">Invigilator: </label><input type="text" name="iniciales"
								id="iniciales2" style="width: 60px; text-transform: uppercase;">
						</p>
					</div>
					<div id="activada2" style="display: none">
						<p style="margin: 10px;">Subject: <span style="padding-right: 10px"
								id="asignaturaactivada2"></span>
							Level: <span id="nivelactivada2" style="padding-right: 10px"></span> Test: <span
								id="pruebaactivada2"></span> </p>
						<p style="margin-top: 10px; margin-bottom: 10px;">Examination Time: <span
								style="padding-right: 30px" id="tiempoactivada2"></span></p>
						<p style="margin-top: 10px;">Invigilator: <span id="inicialesactivada2"
								style="text-transform: uppercase;"></span></p>
					</div>
					<div id="iniciada2" style="display: none">
						<p style="margin: 10px;">Subject: <span style="padding-right: 7px"
								id="asignaturainiciada2"></span>
							Level: <span id="niveliniciada2" style="padding-right: 7px"></span> Test: <span
								id="pruebainiciada2"></span> </p>
						<p style="margin-top: 10px;">Examination Time: <span id="tiempoiniciada2"></span></p>
						<span style="font-size: 170%">
							<p style="margin: 20px;">Start Time: <span id="inicio2"></span> <br />End Time: <span
									id="fin2" style="color: red"></span></p>
							<p style="font-size: x-large; font-weight: bold;">Remaining 30' at <span id="302"
									style="padding-right: 40px"></span>Remaining 5' at <span id="52"></span><br /></p>
						</span>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div style="width: 100%; float: center; margin: 0px;">&nbsp;
		<div id="contenido">
			<div id="botones">
				<input class="button" name="Activar Evaluaciones" type="button" id="activar" value="Activate Evaluations"
					onClick="activar()" style="color: white">
				<input class="button" name="Iniciar Lectura" type="button" id="inlectura" value="Start Reading Time"
					onClick="iniciarlectura()" style="display: none; color: white">
				<input class="button" name="Iniciar Evaluación 1" type="button" id="iniciar" value="Start Examination 1"
					onClick="iniciar()" style="display: none; color: white">
				<input class="button" name="Iniciar Evaluación 2" type="button" id="iniciar2" value="Start Examination 2"
					onClick="iniciar2()" style="display: none; color: white">					
				<input class="button" name="Regresar" type="button" id="regresar" value="Back" onClick="regresar()"
					style="display: none; color: white">
				<input class="button" name="Finalizar" type="button" id="finalizar" value="Finish and Save"
					onClick="guardarLog(); location.href='../IBDP/index-2.html';" style="display: none; color: white">
			</div>
			<div id="timer" style="display: none">
				<h1><br>Reading Time:</h1>
				<h1><span id="tiempolectura">5m 00s</span><br><br></h1>
			</div>
		</div>
	</div>

	<script>
		var x;
		src = "FileSaver.js"

		function startTime() {
			const today = new Date();
			let h = today.getHours();
			let m = today.getMinutes();
			let s = today.getSeconds();
			m = checkTime(m);
			s = checkTime(s);

			document.getElementById('hora').style.color = 'black';
			document.getElementById('30').style.color = 'blue';
			document.getElementById('5').style.color = 'green';
			document.getElementById('hora2').style.color = 'black';
			document.getElementById('302').style.color = 'blue';
			document.getElementById('52').style.color = 'green';
			/*
			document.getElementById('30').style.color = 'black'; 
			document.getElementById('5').style.color = 'black'; 
			document.getElementById('302').style.color = 'black'; 
			document.getElementById('52').style.color = 'black'; 
			*/
			document.getElementById('hora').innerHTML = h + ":" + m + ":" + s;
			document.getElementById('hora2').innerHTML = h + ":" + m + ":" + s;

			const hora = document.getElementById('hora').innerHTML;
			const fin = document.getElementById('fin').innerHTML;
			const min30 = document.getElementById('30').innerHTML;
			const min5 = document.getElementById('5').innerHTML;
			const hora2 = document.getElementById('hora2').innerHTML;
			const fin2 = document.getElementById('fin2').innerHTML;
			const min302 = document.getElementById('302').innerHTML;
			const min52 = document.getElementById('52').innerHTML;

			if (fin !== "") {
				let isHoraMayor = false;
				if (hora > fin) {
					isHoraMayor = true;
				}
				if (isHoraMayor) {
					document.getElementById('hora').style.color = 'red';
				} else {
					document.getElementById('hora').style.color = 'black';
					// Comentar para la otra opción
					if (hora >= min30) {
						document.getElementById('hora').style.color = "blue";
					}
					if (hora >= min5) {
						document.getElementById('hora').style.color = "green";
					}
				}
			}

			if (fin2 !== "") {
				let isHoraMayor2 = false;
				if (hora2 > fin2) {
					isHoraMayor2 = true;
				}
				if (isHoraMayor2) {
					document.getElementById('hora2').style.color = 'red';
				} else {
					document.getElementById('hora2').style.color = 'black';
					// Comentar para la otra opción
					if (hora2 >= min302) {
						document.getElementById('hora2').style.color = "blue";
					}
					if (hora2 >= min52) {
						document.getElementById('hora2').style.color = "green";
					}
				}
			}

			/*
			if (hora >= min30) {
			document.getElementById('30').style.color = "red"; 
			}
			if (hora >= min5) {
			document.getElementById('5').style.color = "red";
			}
			if (hora2 >= min302) {
			document.getElementById('302').style.color = "red"; 
			}
			if (hora2 >= min52) {
			document.getElementById('52').style.color = "red";
			}
			*/

			setTimeout(startTime, 1000);
		}

		function iniciarlectura() {
			var tiempolect = new Date().getTime() + 300000;
			var countDownDate = tiempolect;
			document.getElementById("timer").style.display = "block";

			// Detener el intervalo anterior, si existe
			if (x) {
				clearInterval(x);
				minutes = 5;
				seconds = 0;
				document.getElementById("tiempolectura").innerHTML = minutes + "m " + seconds + "0s ";
			}

			// Update the count down every 1 second
			x = setInterval(function () {

				// Get today's date and time
				var now = new Date().getTime();

				// Find the distance between now and the count down date
				var distance = countDownDate - now;

				// Time calculations for days, hours, minutes and seconds
				var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
				var seconds = Math.floor((distance % (1000 * 60)) / 1000) + 1;

				// Display the result in the element with id="demo"
				document.getElementById("tiempolectura").innerHTML = minutes + "m " + seconds + "s ";

				// If the count down is finished, write some text
				if (distance < 0) {
					clearInterval(x);
					document.getElementById("tiempolectura").innerHTML = "EXPIRED";
					setTimeout(function () {
						document.getElementById("timer").style.display = "none";
					}, 5000);
				}
			}, 1000);
		}

		function activar() {
			document.getElementById("formulario").style.display = "none";
			document.getElementById("activada").style.display = "block";
			document.getElementById("iniciada").style.display = "none";
			document.getElementById("activar").style.display = "none";
			document.getElementById("inlectura").style.display = "inline"
			document.getElementById("iniciar").style.display = "inline";
			document.getElementById("regresar").style.display = "inline";
			document.getElementById("formulario").style.display = "none";
			document.getElementById("asignaturaactivada").innerHTML = document.getElementById('asignatura').value;
			document.getElementById("nivelactivada").innerHTML = document.getElementById('nivel').value;
			document.getElementById("pruebaactivada").innerHTML = document.getElementById('prueba').value;
			document.getElementById("inicialesactivada").innerHTML = document.getElementById('iniciales').value;
			//document.getElementById("tiempoactivada").innerHTML=document.getElementById('tiempo').value;
			var tiempototal = document.getElementById('horasex').value + "H " + document.getElementById('minex').value + "M";
			document.getElementById("tiempoactivada").innerHTML = tiempototal;

			document.getElementById("iniciar2").style.display = "inline";
			document.getElementById("formulario2").style.display = "none";
			document.getElementById("activada2").style.display = "block";
			document.getElementById("iniciada2").style.display = "none";
			document.getElementById("formulario2").style.display = "none";
			document.getElementById("asignaturaactivada2").innerHTML = document.getElementById('asignatura2').value;
			document.getElementById("nivelactivada2").innerHTML = document.getElementById('nivel2').value;
			document.getElementById("pruebaactivada2").innerHTML = document.getElementById('prueba2').value;
			document.getElementById("inicialesactivada2").innerHTML = document.getElementById('iniciales2').value;
			//document.getElementById("tiempoactivada").innerHTML=document.getElementById('tiempo').value;
			var tiempototal2 = document.getElementById('horasex2').value + "H " + document.getElementById('minex2').value + "M";
			document.getElementById("tiempoactivada2").innerHTML = tiempototal2;
		}

		function iniciar() {
			document.getElementById("formulario").style.display = "none";
			document.getElementById("activada").style.display = "none";
			document.getElementById("iniciada").style.display = "block";
			document.getElementById("activar").style.display = "none";
			document.getElementById("iniciar").style.display = "none";
			document.getElementById("inlectura").style.display = "none"
			document.getElementById("regresar").style.display = "none";
			document.getElementById("finalizar").style.display = "inline";
			document.getElementById("asignaturainiciada").innerHTML = document.getElementById('asignatura').value;
			document.getElementById("niveliniciada").innerHTML = document.getElementById('nivel').value;
			document.getElementById("pruebainiciada").innerHTML = document.getElementById('prueba').value;
			document.getElementById("inicialesactivada").innerHTML = document.getElementById('iniciales').value;
			var tiempototal = document.getElementById('horasex').value + "H " + document.getElementById('minex').value + "M";
			document.getElementById("tiempoiniciada").innerHTML = tiempototal;
			document.getElementById("inicio").innerHTML = document.getElementById('hora').innerHTML;
			const d = new Date();
			let timenow = d.getTime();
			let h = document.getElementById('horasex').value;
			let m = document.getElementById('minex').value;
			let time = h * (60000 * 60) + +m * 60000;
			var horadefindeprueba = new Date(timenow + time - 499);
			let hf = horadefindeprueba.getHours();
			let mf = horadefindeprueba.getMinutes();
			let sf = horadefindeprueba.getSeconds();
			mf = checkTime(mf);
			sf = checkTime(sf);
			document.getElementById('fin').innerHTML = hf + ":" + mf + ":" + sf;
			horadefindeprueba = new Date(timenow + time - 1800000 - 499);
			hf = horadefindeprueba.getHours();
			mf = horadefindeprueba.getMinutes();
			sf = horadefindeprueba.getSeconds();
			mf = checkTime(mf);
			sf = checkTime(sf);
			document.getElementById('30').innerHTML = hf + ":" + mf + ":" + sf;
			horadefindeprueba = new Date(timenow + time - 300000 - 499);
			hf = horadefindeprueba.getHours();
			mf = horadefindeprueba.getMinutes();
			sf = horadefindeprueba.getSeconds();
			mf = checkTime(mf);
			sf = checkTime(sf);
			document.getElementById('5').innerHTML = hf + ":" + mf + ":" + sf;
		}

		function iniciar2() {
			document.getElementById("formulario2").style.display = "none";
			document.getElementById("activada2").style.display = "none";
			document.getElementById("iniciada2").style.display = "block";
			document.getElementById("activar").style.display = "none";
			document.getElementById("iniciar2").style.display = "none";
			document.getElementById("inlectura").style.display = "none"
			document.getElementById("regresar").style.display = "none";
			document.getElementById("finalizar").style.display = "inline";
			document.getElementById("asignaturainiciada2").innerHTML = document.getElementById('asignatura2').value;
			document.getElementById("niveliniciada2").innerHTML = document.getElementById('nivel2').value;
			document.getElementById("pruebainiciada2").innerHTML = document.getElementById('prueba2').value;
			var tiempototal2 = document.getElementById('horasex2').value + "H " + document.getElementById('minex2').value + "M";
			document.getElementById("tiempoiniciada2").innerHTML = tiempototal2;
			const d2 = new Date();
			let timenow2 = d2.getTime();
			document.getElementById("inicio2").innerHTML = document.getElementById('hora').innerHTML;
			let h2 = document.getElementById('horasex2').value;
			let m2 = document.getElementById('minex2').value;
			let time2 = h2 * (60000 * 60) + +m2 * 60000;
			var horadefindeprueba2 = new Date(timenow2 + time2 - 499);
			let hf2 = horadefindeprueba2.getHours();
			let mf2 = horadefindeprueba2.getMinutes();
			let sf2 = horadefindeprueba2.getSeconds();
			mf2 = checkTime(mf2);
			sf2 = checkTime(sf2);
			document.getElementById('fin2').innerHTML = hf2 + ":" + mf2 + ":" + sf2;
			horadefindeprueba2 = new Date(timenow2 + time2 - 1800000 - 499);
			hf2 = horadefindeprueba2.getHours();
			mf2 = horadefindeprueba2.getMinutes();
			sf2 = horadefindeprueba2.getSeconds();
			mf2 = checkTime(mf2);
			sf2 = checkTime(sf2);
			document.getElementById('302').innerHTML = hf2 + ":" + mf2 + ":" + sf2;
			horadefindeprueba2 = new Date(timenow2 + time2 - 300000 - 499);
			hf2 = horadefindeprueba2.getHours();
			mf2 = horadefindeprueba2.getMinutes();
			sf2 = horadefindeprueba2.getSeconds();
			mf2 = checkTime(mf2);
			sf2 = checkTime(sf2);
			document.getElementById('52').innerHTML = hf2 + ":" + mf2 + ":" + sf2;
		}

		function regresar() {
			document.getElementById("formulario").style.display = "block";
			document.getElementById("activada").style.display = "none";
			document.getElementById("iniciada").style.display = "none";
			document.getElementById("formulario2").style.display = "block";
			document.getElementById("activada2").style.display = "none";
			document.getElementById("iniciada2").style.display = "none";
			document.getElementById("activar").style.display = "inline";
			document.getElementById("inlectura").style.display = "none"
			document.getElementById("iniciar").style.display = "none";
			document.getElementById("iniciar2").style.display = "none";
			document.getElementById("regresar").style.display = "none";
			document.getElementById('hora').style.color = 'black';
			document.getElementById("timer").style.display = "none";
		}

		function checkTime(i) {
			if (i < 10) { i = "0" + i };  // add zero in front of numbers < 10
			return i;
		}

		var elem = document.documentElement;

		/* View in fullscreen */
		if (elem.requestFullscreen) {
			elem.requestFullscreen();
		} else if (elem.webkitRequestFullscreen) { /* Safari */
			elem.webkitRequestFullscreen();
		} else if (elem.msRequestFullscreen) { /* IE11 */
			elem.msRequestFullscreen();
		}

		/* Close fullscreen */
		function closeFullscreen() {
			if (document.exitFullscreen) {
				document.exitFullscreen();
			} else if (document.webkitExitFullscreen) { /* Safari */
				document.webkitExitFullscreen();
			} else if (document.msExitFullscreen) { /* IE11 */
				document.msExitFullscreen();
			}
		}

		function guardarLog() {
			// Obtener los valores de los campos del formulario
			var asignatura = document.getElementById("asignatura").value;
			var nivel = document.getElementById("nivel").value;
			var prueba = document.getElementById("prueba").value;
			var duracionHoras = document.getElementById("horasex").value;
			var duracionMinutos = document.getElementById("minex").value;
			var horaInicio = document.getElementById("inicio").textContent;
			var horaFin = document.getElementById("fin").textContent;
			var inicialesR = document.getElementById("iniciales").value;
			let inicialesCL = inicialesR.toUpperCase();

			// Obtener los valores de los campos del formulario
			var asignatura2 = document.getElementById("asignatura2").value;
			var nivel2 = document.getElementById("nivel2").value;
			var prueba2 = document.getElementById("prueba2").value;
			var duracionHoras2 = document.getElementById("horasex2").value;
			var duracionMinutos2 = document.getElementById("minex2").value;
			var horaInicio2 = document.getElementById("inicio2").textContent;
			var horaFin2 = document.getElementById("fin2").textContent;
			var inicialesR2 = document.getElementById("iniciales2").value;
			let inicialesCL2 = inicialesR2.toUpperCase();

			// Obtener la fecha actual
			var fechaActual = new Date().toISOString().slice(0, 10);

			// Crear el nombre del archivo con la información obtenida
			var nombreArchivo = "Examination Session IBDP - GCLC - " + fechaActual + ".txt";

			// Crear el contenido del archivo
			var contenidoArchivo = "Examinations Date: " + fechaActual + "\r\n" +
				"------------------------------------ \r\n" +	
				"Examination 1: \r\n" +
				"Supervisor: " + inicialesCL + "\r\n" +
				"Subject: " + asignatura + "\r\n" +
				"Test Level 1: " + nivel + "\r\n" +
				"Test: " + prueba + "\r\n" +
				"Duration in Hours: " + duracionHoras + "\r\n" +
				"Duration in Minutes: " + duracionMinutos + "\r\n" +
				"Start Time: " + horaInicio + "\r\n" +
				"End Time: " + horaFin + "\r\n" +
				"------------------------------------ \r\n" +
				"Prueba 2: \r\n" +
				"Supervisor: " + inicialesCL2 + "\r\n" +
				"Subject: " + asignatura2 + "\r\n" +
				"Test Level 2: " + nivel2 + "\r\n" +
				"Test: " + prueba2 + "\r\n" +
				"Duration in Hours: " + duracionHoras2 + "\r\n" +
				"Duration in Minutes: " + duracionMinutos2 + "\r\n" +
				"Start Time:" + horaInicio2 + "\r\n" +
				"End Time: " + horaFin2;

			// Crear un objeto Blob con el contenido del archivo
			var blob = new Blob([contenidoArchivo], { type: "text/plain;charset=utf-8" });

			// Guardar el archivo
			saveAs(blob, nombreArchivo);
		}

	</script>
</body>

</html>